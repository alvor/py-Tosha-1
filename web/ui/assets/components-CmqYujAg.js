import{r as k,d as T,a as F,c as i,o as n,F as j,b as O,e as L,n as $,w as P,f as e,g as E,h as J,i as v,j as X,k as I,T as Z,u as w,v as Q,t as m,K as ae,l as ne,m as Y,p as z,q as D,s as A,x as ee,y as q,z as oe,A as ie,B as ce}from"./vendor-DvXVR_nU.js";import{u as K,a as te}from"./router-BXCsT2D4.js";const ue="/assets2/py-tosha-a.svg",le="/assets2/py-Tosha.svg",se="/assets2/ios_spin.svg",C=k("http://192.168.1.108/"),b=k({}),re={class:"nav d-md2-none"},de=["src"],_e={key:1,class:"space"},ve=T({__name:"Nav_Bar",setup(x){const o=[{img:"/assets2/net_wifi.svg",to:"/network",label:"network"},{img:"/assets2/folder_files.svg",to:"/files",label:"files"},{img:"/assets2/info.svg",to:"/info",label:"info"},{img:"/assets2/switches.svg",to:"/switches",label:"switch"},{img:"/assets2/schedule.svg",to:"/cron_scheduler",label:"scheduler"},{img:"",to:"",label:""},{img:"/assets2/settings.svg",to:"/settings",label:"settings"}];return(c,t)=>{const _=F("router-link");return n(),i("nav",re,[(n(),i(j,null,O(o,u=>(n(),i(j,null,[u.label?(n(),L(_,{key:0,class:$(["btn my-2 _mx-auto",{hilith:c.$route.path==u.to}]),title:u.label,to:u.to},{default:P(()=>[e("img",{src:u.img},null,8,de)]),_:2},1032,["title","class","to"])):(n(),i("div",_e))],64))),64))])}}}),M=(x,o)=>{const c=x.__vccOpts||x;for(const[t,_]of o)c[t]=_;return c},fe=M(ve,[["__scopeId","data-v-06fe0caa"]]),me={class:"layout"},pe={key:"1",src:ue,class:"ma-1",alt:"py-Tosha logo"},he={key:"2",src:le,class:"ma-1",alt:"py-Tosha logo"},ge={key:"2",src:le,class:"ma-1",alt:"py-Tosha logo"},ye={key:"2",src:se,class:"ma-1",alt:"py-Tosha logo"},be={style:{position:"relative"}},$e={style:{"_padding-left":"50px"}},ke=T({__name:"LayoutDefault",setup(x){let o=k(!0);const c=K();let t=k(!1);setTimeout(()=>t.value=!0,2222);const _=E(()=>{var a;return((a=b.value)==null?void 0:a.datetime)&&new Date(b.value.datetime).toISOString().slice(8,16).replace("T"," ")});let u=null;return J(()=>c.name,()=>{clearTimeout(u),u=setTimeout(()=>o.value=!1,7e3),!o.value&&setTimeout(()=>o.value=!0,400)}),(a,d)=>{const p=F("router-link"),r=F("router-view");return n(),i("div",me,[e("header",null,[v(p,{to:"/",_target:"_blank",class:$(["logo",{home:a.$route.name!="home"}])},{default:P(()=>[v(Z,{name:"fade"},{default:P(()=>[w(o)?(n(),i("img",pe)):(n(),i("img",he))]),_:1}),w(t)?X((n(),i("img",ge,null,512)),[[Q,!1]]):I("",!0)]),_:1},8,["class"]),w(t)?X((n(),i("img",ye,null,512)),[[Q,!1]]):I("",!0),e("div",be,[v(Z,{name:"blurslide",appear:""},{default:P(()=>[(n(),i("h2",{class:"title text-h2",key:a.$route.meta.label||"py-Tosha"},m(a.$route.meta.label||"py-Tosha"),1))]),_:1})])]),e("main",$e,[v(fe),v(r,{class:"view"},{default:P(({Component:l})=>[v(Z,{name:"pagefade","_before-enter":"over_hide=true",_enter:"onEnter","_after-enter":"over_hide=false","_enter-cancelled":"over_hide=false"},{default:P(()=>[(n(),L(ae,{max:"3",key:w(C)},[(n(),L(ne(l),{class:"viewG"}))],1024))]),_:2},1024)]),_:1})]),e("footer",null,[e("ul",null,[e("li",{class:$({"bg-warn":w(b).err})},m(_.value),3),e("li",{class:$({"bg-warn":w(b).err})},"mem: "+m(~~(w(b).mem_free/100)/10)+"k",3),e("li",{class:$({"bg-warn":w(b).err})},"cpu: "+m(~~(w(b).load*100+1))+"%",3)])])])}}}),Gt=M(ke,[["__scopeId","data-v-01667072"]]),we={key:0,src:se},xe={key:1,class:"mx-2",style:{"flex-grow":"1"}},Ce=T({__name:"ZButton",props:{to:{type:[Object,String],required:!1},label:{},ladge:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},setup(x){return(o,c)=>{const t=F("router-link");return x.to?(n(),L(t,{key:0,class:$(["btn my-2 gggg _mx-auto",{ladge:x.ladge}]),to:x.to},{default:P(()=>[z(m(x.label),1)]),_:1},8,["class","to"])):(n(),i("a",{key:1,class:$(["btn my-2 _mx-auto",{ladge:x.ladge}]),_to:"to"},[Y(o.$slots,"prepend",{},void 0),x.loading?(n(),i("img",we)):(n(),i("span",xe,m(x.label),1))],2))}}}),f=M(Ce,[["__scopeId","data-v-8aab3b82"]]),Se={class:"wrapper"},Te={class:"d-flex_"},je=T({__name:"home",setup(x){return(o,c)=>(n(),i("div",Se,[e("div",Te,[e("div",null,[v(f,{ladge:"",to:"/network",label:"network"})]),e("div",null,[v(f,{ladge:"",to:"/files",label:"files"})]),e("div",null,[v(f,{ladge:"",to:"/info",label:"info"})]),e("div",null,[v(f,{ladge:"",to:"/switches",label:"switches"})]),e("div",null,[v(f,{ladge:"",to:"/standard",label:"standard"})]),e("div",null,[v(f,{ladge:"",to:"/cron_scheduler",label:"scheduler"})]),e("div",null,[v(f,{ladge:"",to:"/servers_api",label:"servers-api list"})]),e("div",null,[v(f,{ladge:"",to:"/settings",label:"settings"})])])]))}}),Oe=M(je,[["__scopeId","data-v-c1caa1c8"]]),Ht=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"})),Pe={class:"row pa-2"},Ie={class:"row pa-2"},Le={class:"col-md-12 _col-4 px-2 text-b"},Ne={class:"col-md-12 col-8 px-2"},ze={key:0,style:{"justify-items":"left"}},De={class:"txt-left"},Me={key:1},Be={class:"txt-left"},Ee={class:"txt-primary"},Ue=T({__name:"info",setup(x){const o=k(null);let c=null;function t(){fetch(`${C.value}api/status`).then(async a=>{if(a.ok){const d=await a.json();o.value=d}else o.value=[]}).catch(a=>o.value=[])}const _=E(()=>{var a;return((a=b.value)==null?void 0:a.datetime)&&new Date(b.value.datetime).toISOString().slice(8,16).replace("T"," ")});function u(){t()}return D(()=>{c=!0,t()}),A(()=>{c=!1}),J(()=>b.value.err,a=>{!a&&c&&t()}),(a,d)=>(n(),i("div",null,[d[1]||(d[1]=e("h3",null,"Информация",-1)),v(f,{onClick:d[0]||(d[0]=p=>a.$router.go(-1)),label:"<<",class:"mx-2"}),v(f,{onClick:u,label:"refresh"}),e("div",Pe,[e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])}," PLC time: "+m(_.value),3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"Free mem: "+m(~~(w(b).mem_free/100)/10)+"k",3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"UpTime: "+m(~~(w(b).uptime/60))+"min",3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"CPU load: "+m(~~(w(b).load*100+1))+"%",3)]),(n(!0),i(j,null,O(o.value,(p,r)=>(n(),i("div",Ie,[e("div",Le,m(p.name),1),e("div",Ne,[Array.isArray(p.state)?(n(),i("div",ze,[(n(!0),i(j,null,O(p.state,l=>(n(),i("div",De,m(l),1))),256))])):(n(),i("div",Me,[(n(!0),i(j,null,O(p.state,(l,s)=>(n(),i("div",Be,[e("b",Ee,m(s),1),z("="+m(l),1)]))),256))]))])]))),256))]))}}),Wt=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"})),Je={class:"row px-2"},Ae={class:"list_files col-8 col-sm-12"},Re={class:"col-12 ma-2"},qe={class:"ant mx-2"},Fe=["onClick"],Ke=T({__name:"network",setup(x){const o=k([]),c=k(""),t=k(!1);let _=0,u;function a(){t.value||(t.value=!0,fetch(`${C.value}api/net/scan`).then(async l=>{if(l.ok){const s=await l.json();c.value=s.connected,o.value=o.value.filter(h=>!s.available.find(N=>h[1]==N[1])&&h[6]+6>~~(Date.now()/1e3/60)),o.value.push(...s.available.map(h=>(h[0]=h[0]||h[1],h[6]=~~(Date.now()/1e3/60),h))),o.value=o.value.sort((h,N)=>h[3]>N[3]?-1:h[3]<N[3]?1:0)}}).finally(()=>{t.value=!1,!(_>3)&&(_++,u=setTimeout(a,(.5+_/3)*60*1e3))}))}function d(){if(!t.value&&confirm("Подтвердите действие - забыть сеть")){t.value=!0;const l={method:"delete"};fetch(`${C.value}api/net/config`,l).then(async s=>{s.ok&&(c.value="")}).finally(()=>{t.value=!1})}}function p(l){if(t.value)return;const s=prompt(`Введите ключ подключения к сетти ${l}`,"");if(s){t.value=!0;const h={method:"post",body:JSON.stringify({ssid:l,pswd:s})};fetch(`${C.value}api/net/config`,h).then(async N=>{N.ok}).finally(()=>{t.value=!1,a()})}}D(()=>{a()}),A(()=>{clearTimeout(u)});function r(l){return(l+99)*1.8}return(l,s)=>(n(),i("div",null,[v(f,{onClick:s[0]||(s[0]=h=>l.$router.go(-1)),label:"<<"}),s[3]||(s[3]=e("h2",{class:"ma-2"}," Network connection",-1)),e("div",Je,[s[2]||(s[2]=e("div",{class:"list_files_ col-4 col-sm-12 justify-cc",style:{"padding-top":"8px"}}," Список доступных сетей: ",-1)),e("div",Ae,[v(f,{onClick:s[1]||(s[1]=h=>{ee(_)?_.value=1:_=1,a()}),label:"scan",loading:t.value,style:{width:"90px"}},null,8,["loading"]),(n(!0),i(j,null,O(o.value,h=>(n(),i("div",Re,[e("div",null,m(c.value==h[0]?"*":"")+" "+m(h[0]),1),e("div",qe,[e("div",{class:"progress",style:q(`height:${r(h[3])}% ; width:${r(h[3])}% `)},null,4)]),e("div",null,[c.value==h[0]?(n(),i("a",{key:0,class:"cursor-p",onClick:d}," забыть ")):(n(),i("a",{key:1,class:"cursor-p",onClick:N=>p(h[0])}," подключить ",8,Fe))])]))),256))])])]))}}),Ve=M(Ke,[["__scopeId","data-v-3cf940e9"]]),Xt=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"})),Ze={class:"row px-2",style:{"min-height":"5px"}},Ge={class:"list_files row"},He={class:"col-4 col-md-6 col-sm-12 align-ic px-2"},We=["onClick"],Xe={class:"row pa-2",style:{"white-space":"break-spaces"}},Qe={class:"col-3 col-md-4 col-sm-6"},Ye={class:"text-b"},et={class:"col-3 col-md-4 col-sm-6"},tt={class:"text-b"},lt={class:"col-3 col-md-4 col-sm-6"},st={class:"text-b"},at=T({__name:"files",setup(x){const o=k([]),c=k({used:null,free:null,total:null}),t=k(null),_=te(),u=k(!1);function a(r=""){u.value=!0,fetch(`${C.value}api/ls/${r}`).then(async l=>{if(l.ok){const s=await l.json();if(!s)return;o.value=s.files,c.value.free=s.free,c.value.total=s.total,c.value.used=s.used,t.value=s.currdir}}).finally(()=>u.value=!1)}function d(r=""){confirm("Готовы удалить этот файл или папку?")&&fetch(`${C.value}api/delete/${r}`,{method:"delete"}).then(async l=>{l.ok?a():alert("Ошибка, что-то пошло не так...")}).catch(l=>alert("Ошибка, что-то пошло не так..."))}function p(r,l){l===16384&&a(`?chdir=${r}`),l===32768&&_.push({name:"show_content",query:{file_name:r}})}return D(()=>{setTimeout(()=>{a()},9)}),(r,l)=>(n(),i("div",null,[o.value.find(s=>s[0]=="/")?(n(),L(f,{key:0,onClick:l[0]||(l[0]=s=>p("/",16384)),label:"/",class:"mx-2"})):I("",!0),o.value.find(s=>s[0]=="..")?(n(),L(f,{key:1,onClick:l[1]||(l[1]=s=>p("..",16384)),label:"<<",class:"mx-2"})):I("",!0),v(f,{onClick:l[2]||(l[2]=s=>a()),label:"refresh",class:"mx-2"}),v(f,{_click:"set_params(r)",label:"upload",class:"mx-2"}),e("h3",null,"Current dir: "+m(t.value),1),e("div",Ze,[e("div",{v_if:"loading",class:$(["loader",{loading:u.value}])},null,2)]),e("div",Ge,[(n(!0),i(j,null,O(o.value,s=>(n(),i("div",He,[e("span",{class:$(["file_nm",{folder:s[1]==16384}]),onClick:h=>p(s[0],s[1])},m(s[0]),11,We),e("span",null,[v(f,{_click:"scan",onClick:h=>d(s[0]),label:"x"},null,8,["onClick"])])]))),256))]),e("div",Xe,[e("div",Qe,[l[3]||(l[3]=z(" total: ")),e("span",Ye,m(~~(c.value.total/100)/10)+" K",1)]),e("div",et,[l[4]||(l[4]=z(" free: ")),e("span",tt,m(~~(c.value.free/100)/10)+" K",1)]),e("div",lt,[l[5]||(l[5]=z(" used: ")),e("span",st,m(~~(c.value.used/100)/10)+" K",1)])])]))}}),nt=M(at,[["__scopeId","data-v-97243bc8"]]),Qt=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"})),ot={style:{position:"sticky",top:"0",left:"0","max-width":"inherit"}},it={class:"row px-2",style:{"min-height":"5px"}},ct={class:"list_files row px-2",style:{"_max-width":"inherit"}},ut=["contenteditable","textContent"],rt=T({__name:"show_content",setup(x){const o=k(null),c=K();let t=null;const _=k(!1);let u=k(!1);const a=k([]);function d(){_.value=!0,fetch(`${C.value}show_content/?file_name=${t}`).then(async l=>{if(l.ok){u.value=!1;const s=await l.text();o.value=s,a.value=s.split(`
`),p.value=!1}}).finally(l=>_.value=!1)}D(()=>{if(t===c.query.file_name)return;o.value=null,t=c.query.file_name,setTimeout(()=>{d()},9);const l=document.querySelector("#f_content");l.oninput=()=>p.value=!0});const p=k(!1);function r(l){const s=new FormData,h=document.querySelector("#f_content");let V=new URLSearchParams(document.location.search).get("file_name");const R=h.textContent;let g=new Blob([R],{type:"text/plain"});s.append("files",g);const y=new XMLHttpRequest;y.open("PUT",`${C.value}api/upload/${V}`,!0),y.addEventListener("load",()=>{_.value=!1,p.value=!1}),y.onreadystatechange=function(){y.readyState==4&&d()},y.addEventListener("error",()=>{_.value=!1,alert("Upload Error!")}),_.value=!0,y.send(R)}return(l,s)=>(n(),i("div",null,[e("div",ot,[v(f,{onClick:s[0]||(s[0]=h=>l.$router.go(-1)),label:"<<",class:"mx-2"}),v(f,{onClick:s[1]||(s[1]=h=>d()),label:"refresh",class:"mx-2"}),v(f,{onClick:s[2]||(s[2]=h=>ee(u)?u.value=!w(u):u=!w(u)),label:"edit",class:"mx-2"}),w(u)||p.value?(n(),L(f,{key:0,class:"mx-2 bg-warn",onClick:r,label:"save"})):I("",!0)]),e("h3",null,m(l.$route.query.file_name),1),e("div",it,[e("div",{v_show:"loading",class:$(["loader",{loading:_.value}])},null,2)]),e("div",ct,[e("pre",{v_if:"!edit_mode",contenteditable:w(u),id:"f_content",style:{"white-space":"pre-wrap","background-color":"#eeeeee",padding:"2px"},textContent:m(o.value),_input:"file_content = $event.target.innerText ",onBlur:s[3]||(s[3]=h=>o.value=h.target.innerText)},null,40,ut),I("",!0)])]))}}),dt=M(rt,[["__scopeId","data-v-fd44aa78"]]),Yt=Object.freeze(Object.defineProperty({__proto__:null,default:dt},Symbol.toStringTag,{value:"Module"})),_t={class:"row px-2"},vt={class:"col-6 col-md-12 px-2 _text-b align-ic"},ft={class:"mx-2"},mt=T({__name:"switches",setup(x){const o=k(null);let c,t=0;function _(){c&&c.close(),c=new EventSource(`${C.value}api/switches/ls/?check_id=${t}`,{__withCredentials:!0,__heartbeatTimeout:12e4}),c.onmessage=a=>{try{const d=JSON.parse(a.data);t=a.lastEventId,o.value=d}catch(d){console.warn("evtSource_message_22: ",a.data.slice(0,4),a.data,d)}}}function u(a){const d={method:"put",body:JSON.stringify([{id:a.id,value:a.value}])};fetch(`${C.value}api/switches/set`,d).then(async p=>{p.ok})}return D(()=>{_()}),A(()=>{c&&c.close()}),(a,d)=>{var p,r;return n(),i("div",null,[v(f,{onClick:d[0]||(d[0]=l=>a.$router.go(-1)),label:"<<",class:"mx-2"}),d[1]||(d[1]=e("h3",null,"Switch view block ",-1)),e("div",_t,[(n(!0),i(j,null,O((p=o.value)==null?void 0:p.data,l=>(n(),i("div",vt,[v(f,{onClick:s=>{l.value=!l.value,u(l)},ladge:"",label:(l==null?void 0:l.name)||"switch"},{prepend:P(()=>[e("div",{class:$(["lamp",{on:l.value===1,off:l.value===0}]),_label:"switch"},null,2)]),_:2},1032,["onClick","label"]),e("div",{class:$(["lamp",{on:l.value===1,off:l.value===0}]),_label:"switch"},null,2),e("span",ft,m(l.id)+" = "+m(l.value),1)]))),256))]),z(" tt: "+m((r=o.value)==null?void 0:r.time),1)])}}}),el=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),pt={class:"mx-2"},ht=T({__name:"ZIndicator",props:{value:{}},setup(x){const o=k(!1),c=x,t=E(()=>c.value),_=E(()=>c.value.direction||"right"),u=E(()=>{const a=t.value.max-t.value.min;return Math.round((t.value.value-t.value.min)*100/a)});return J(()=>t.value.value,()=>{o.value=!0,setTimeout(()=>o.value=!1,3222)}),(a,d)=>(n(),i("div",{class:$(["indicator my-2",{digital:t.value.indicator=="digital"}])},[t.value.indicator=="digital"&&!["digital"].includes(t.value.control)?(n(),i("div",{key:0,class:"mx-2 digital2",style:q([`background-color: ${t.value.value?"#114422":"#00cc66"} ;`])},null,4)):t.value.indicator=="analog"&&(t.value.min||t.value.max)&&["right","left"].includes(_.value)?(n(),i("div",{key:1,class:$(["mx-2 analog horisontal",[t.value.class,"dir-"+(t.value.direction||"right")]])},[e("div",{style:q([`width: ${u.value}%;`])},null,4)],2)):t.value.indicator=="analog"&&(t.value.min||t.value.max)?(n(),i("div",{key:2,class:$(["mx-2 analog",[t.value.class,"dir-"+t.value.direction||"right"]]),_style:"[]"},[e("div",{style:q([`height: ${u.value}%;`])},null,4)],2)):(n(),i("div",{key:3,class:$(["mx-2 any",[t.value.class]]),_style:"[`background-color: ${!value ? '#00cc66':'#114422'} ;`]"},null,2)),Y(a.$slots,"prepend",{},void 0),e("span",pt,m(t.value.name),1),t.value.indicator=="analog"?(n(),i("span",{key:4,class:$(["px-2 value text-b",{modified:o.value}])},m(t.value.value)+" "+m(t.value.measure),3)):I("",!0)],2))}}),gt=M(ht,[["__scopeId","data-v-c42b9416"]]),yt={class:"row px-2"},bt={class:"col-4 col-md-6 col-sm-12 px-2 pa-md-2 _text-b align-ic justify-cc"},$t=T({__name:"standard_det",setup(x){const o=k(null);let c,t=0;const _=K(),u=k(null),a=k(null);function d(){c&&c.close(),c=new EventSource(`${C.value}api/standard/${u.value}`,{__withCredentials:!0,__heartbeatTimeout:12e4}),c.onmessage=r=>{try{const l=JSON.parse(r.data);t=r.lastEventId,u.value=l.name,a.value=l.label,o.value=l.data}catch(l){console.warn("evtSource_message_22: ",r.data.slice(0,4),r.data,l)}}}function p(r,l){const s={method:"put",body:JSON.stringify([{id:r.id,value:l}])};fetch(`${C.value}api/standard/set/${u.value}`,s).then(async h=>{h.ok})}return J(()=>{var r;return(r=_.query)==null?void 0:r.nm_module},r=>{console.log("onWatch_29: ",r),r&&r!==u.value&&(c&&c.close(),d())}),oe(()=>{var r;u.value=(r=_.query)==null?void 0:r.nm_module,d()}),ie(()=>{c&&c.close()}),(r,l)=>(n(),i("div",null,[v(f,{onClick:l[0]||(l[0]=s=>r.$router.go(-1)),label:"<<",class:"mx-2"}),e("h3",null,m(a.value),1),e("div",yt,[(n(!0),i(j,null,O(o.value,s=>(n(),i("div",bt,[s.indicator!="digital"||!["digital"].includes(s.control)?(n(),L(gt,{key:0,value:s,onClick:h=>r.set_page(s),style:{"flex-grow":"2"}},{default:P(()=>[z(m(s.name),1)]),_:2},1032,["value","onClick"])):I("",!0),["digital"].includes(s.control)?(n(),L(f,{key:1,_class:"ma-md-2",onClick:h=>p(s,!s.value),style:{"flex-grow":"1"},ladge:"",label:s.name},ce({default:P(()=>[l[1]||(l[1]=z(" * "))]),_:2},[s.indicator=="digital"?{name:"prepend",fn:P(()=>[e("div",{class:$(["lamp",{on:s.value===1,off:s.value===0}]),_label:"switch"},null,2)]),key:"0"}:void 0]),1032,["onClick","label"])):I("",!0)]))),256))])]))}}),kt={key:1},wt={class:"row px-2"},xt={class:"col-6 col-md-12 px-2 _text-b align-ic justify-cc"},Ct=T({__name:"standard",setup(x){const o=k(null),c=te();function t(){fetch(`${C.value}api/standard/ls`).then(async u=>{if(u.ok){const a=await u.json();o.value=a.modules}})}function _([u,a]){c.push({name:"standard",params:{nm_module:u},query:{nm_module:u,label:a}})}return D(()=>{t()}),A(()=>{}),(u,a)=>{var d,p;return n(),i("div",null,[(d=u.$route.query)!=null&&d.nm_module?(n(),L($t,{key:0})):I("",!0),(p=u.$route.query)!=null&&p.nm_module?I("",!0):(n(),i("div",kt,[a[0]||(a[0]=e("h3",null," Standard modules ",-1)),e("div",wt,[(n(!0),i(j,null,O(o.value,r=>(n(),i("div",xt,[v(f,{onClick:l=>_(r),ladge:"",label:r[1]},null,8,["onClick","label"])]))),256))])]))])}}}),tl=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),St={class:"row pa-2"},Tt={class:"row pa-md-2"},jt={class:"col-md-12 _col-4 px-2 text-b"},Ot={class:"col-md-12 _col-8 _px-2"},Pt={class:"row pa-md-2"},It={class:"col-md-12 _col-6 _pa-md-2",style:{"flex-grow":"1"}},Lt={class:"col-12 pa-2",v__for:"(r,i) in cron_list?.tasks",__style:"width: 650px;",style:{overflow:"auto","_max-width":"calc(100vw - 30px)"}},Nt={class:"px-2"},zt={class:"col-md-12 _col-6 px-2",style:{"flex-grow":"1"}},Dt={class:"col-12 pa-2 align-ic"},Mt={class:"px-2"},Bt={class:"col-12 _px-2 align-ic"},Et=T({__name:"cron_scheduler",setup(x){const o=k(null);let c=null;const t=k(!1),_=k(null),u=k(void 0);function a(){t!=!0&&fetch(`${C.value}api/cron/ls`).then(async g=>{if(g.ok){const y=await g.json();o.value=y,t.value=!1}else sys_info.value=[]}).catch(g=>sys_info.value=[])}function d(){t!=!0&&fetch(`${C.value}api/cron/ls/reload`).then(async g=>{if(g.ok){const y=await g.json();o.value=y,t.value=!1}else sys_info.value=[]}).catch(g=>sys_info.value=[])}const p=E(()=>{var g;return((g=b.value)==null?void 0:g.datetime)&&new Date(b.value.datetime).toISOString().slice(8,16).replace("T"," ")});function r(g){o.value.tasks.push([!0,"- * * * *",g[0],g[2],g[1]])}function l(g){const y=prompt("Input schedule format [* * * * *] ",g[1]);y.trim().split(/\s+/).length==5&&(g[1]=y,t.value=!0)}function s(g){const y=prompt("Input params ",JSON.stringify(g[3]));if(y!==null){try{g[3]=JSON.parse(y)}catch{g[3]="params"}t.value=!0}}function h(g){const y=prompt("Input label ",g[4]);y!==null&&(g[4]=y,t.value=!0)}function N(){a()}D(()=>{c=!0,a()}),A(()=>{c=!1});function V(){const g={method:"put",body:JSON.stringify(o.value.tasks)};fetch(`${C.value}api/cron/set`,g).then(async y=>{y.ok&&a()}).catch(y=>{})}J(()=>b.value.err,g=>{!g&&c&&a()});function R(g){if(_.value===null){_.value=g;return}if(_.value==g){_.value=null,u.value=void 0;return}u.value=g,setTimeout(()=>{o.value.tasks.splice(g,0,o.value.tasks.splice(_.value,1)[0]),_.value=null,t.value=!0,u.value=void 0},455)}return(g,y)=>{var G,H,W;return n(),i("div",null,[v(f,{onClick:y[0]||(y[0]=S=>g.$router.go(-1)),label:"<<",class:"mx-2"}),v(f,{onClick:y[1]||(y[1]=S=>{t.value=!1,N()}),label:"refresh"}),v(f,{onClick:y[2]||(y[2]=S=>{t.value=!1,d()}),label:"reload"}),e("div",St,[e("div",{class:$(["col-4 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])}," UpTime: "+m(~~(w(b).uptime/60))+"min ",3),e("div",{class:$(["col-4 col-sm-12 pa-2 justify-cc",{"bg-warn":w(b).err}])}," PLC time: "+m(p.value),3)]),y[6]||(y[6]=e("h3",null,"Cron tab",-1)),e("div",Tt,[e("div",jt,m((G=o.value)==null?void 0:G.name),1),e("div",Ot,[e("div",Pt,[e("div",It,[y[3]||(y[3]=e("div",{class:"col-12 px-2"}," Cron table: ",-1)),e("div",Lt,[(n(!0),i(j,null,O((H=o.value)==null?void 0:H.tasks,(S,B)=>(n(),i("div",{class:$(["_mx-2 d-flex_ tab_wrap",{up:_.value===B&&_.value>u.value,down:_.value===B&&_.value<u.value}])},[v(f,{onClick:U=>R(B),label:_.value===B?"<>":B+".",title:"position",class:$({ch_index:_.value===B})},null,8,["onClick","label","class"]),v(f,{class:$([S[0]?"_bg-positive":"bg-secondary"]),onClick:U=>{S[0]=!S[0],t.value=!0},label:S[0]?"o":"~",_label:"o"},null,8,["class","onClick","label"]),v(f,{onClick:U=>l(S),label:S[1]},null,8,["onClick","label"]),e("span",Nt,m(S[2]),1),v(f,{onClick:U=>s(S),label:S[3]},null,8,["onClick","label"]),v(f,{onClick:U=>h(S),label:S[4]},null,8,["onClick","label"]),v(f,{onClick:U=>{o.value.tasks.splice(B,1),t.value=!0},label:"-"},null,8,["onClick"])],2))),256))])]),e("div",zt,[e("div",Dt,[y[4]||(y[4]=z(" Command's: ")),e("span",Mt,[t.value?(n(),L(f,{key:0,class:"bg-warn",onClick:V,label:"Save"})):I("",!0)])]),(n(!0),i(j,null,O((W=o.value)==null?void 0:W.cmd_list,(S,B)=>(n(),i("div",Bt,[z(m(S)+" ",1),v(f,{onClick:U=>{r(S),t.value=!0},label:"+"},null,8,["onClick"])]))),256))])]),y[5]||(y[5]=e("pre",{class:"txt-left pa-md-2_ pa-2",style:{"white-space":"break-spaces"}},`Schedule string: "* * * * *" as position "mm hh dw dd my" where:
mm - minutes,
hh - hours,
dw - day of week (1-mo, 2-tu, ..., 7-su),
dd - day of month,
my - month of year,
format: every position * may be as any number;
 integer number;
 range of number 2-9;
 list 1,2,3;
 number with delimiter (example: */3 for step every third), range with step throw delimiter 4-20/4 every fourth
      `,-1))])])])}}}),Ut=M(Et,[["__scopeId","data-v-7d7648e9"]]),ll=Object.freeze(Object.defineProperty({__proto__:null,default:Ut},Symbol.toStringTag,{value:"Module"})),Jt={class:"row pa-2"},At={class:"row pa-2"},Rt=T({__name:"settings",setup(x){const o=k(null);let c=null;function t(){fetch(`${C}api/status`).then(async a=>{if(a.ok){const d=await a.json();o.value=d}else o.value=[]}).catch(a=>o.value=[])}const _=E(()=>{var a;return((a=b.value)==null?void 0:a.datetime)&&new Date(b.value.datetime).toISOString().slice(8,16).replace("T"," ")});function u(){t()}return D(()=>{c=!0,t()}),A(()=>{c=!1}),J(()=>b.value.err,a=>{!a&&c&&t()}),(a,d)=>(n(),i("div",null,[v(f,{onClick:d[0]||(d[0]=p=>a.$router.go(-1)),label:"<<",class:"mx-2"}),v(f,{onClick:u,label:"refresh"}),d[2]||(d[2]=e("h3",null,"Settings - settings",-1)),e("div",Jt,[e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])}," PLC time: "+m(_.value),3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"Free mem: "+m(~~(w(b).mem_free/100)/10)+"k",3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"UpTime: "+m(~~(w(b).uptime/60))+"min",3),e("div",{class:$(["col-3 col-sm-6 pa-2 justify-cc",{"bg-warn":w(b).err}])},"CPU load: "+m(~~(w(b).load*100+1))+"%",3)]),(n(!0),i(j,null,O(o.value,(p,r)=>(n(),i("div",At,d[1]||(d[1]=[e("div",{class:"col-md-12 _col-4 px-2 _text-b"}," Page in dev mode ",-1)])))),256))]))}}),sl=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"})),qt={class:"row px-2"},Ft={class:"col-6 col-md-12 px-2 _text-b align-ic justify-cc"},Kt=T({__name:"servers_api",setup(x){const o=K();k(null);const c=k(C),t=k([{name:"main-this '/'",host:"/",state:""},{name:"PLC- reserv .1.108",host:"http://192.168.1.108/",state:""},{name:"PLC-holl-2 .5.115",host:"http://192.168.5.115/",state:""},{name:"PLC-pole-3 .5.166",host:"http://192.168.5.166/",state:""},{name:"PLC-wirpool-4 .1.108",host:"http://192.168.1.108/",state:""}]);let _=null;function u(){o.name=="servers_api"&&(t.value.forEach((d,p)=>{setTimeout(()=>{fetch(`${d.host}ping`).then(async r=>{r.ok&&(await r.text()).search("pong")===0?d.state=!0:d.state=!1}).catch(r=>d.state=!1)},p*300)}),_=setTimeout(u,737*1e3))}D(()=>{clearTimeout(_),u()});function a(d){C.value=d.host,localStorage.setItem("current_host",C.value)}return(d,p)=>(n(),i("div",null,[v(f,{onClick:p[0]||(p[0]=r=>d.$router.go(-1)),label:"<<",class:"mx-2"}),p[1]||(p[1]=e("h3",null,"Servers REST API",-1)),e("h5",null,"current host: "+m(c.value),1),e("div",qt,[(n(!0),i(j,null,O(t.value,r=>(n(),i("div",Ft,[v(f,{onClick:l=>a(r),ladge:"",label:(r==null?void 0:r.name)||"switch"},{prepend:P(()=>[e("div",{class:$(["lamp",{on:r.state,off:r.state===!1}]),_label:"switch"},null,2)]),_:2},1032,["onClick","label"])]))),256))])]))}}),al=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"}));export{Gt as L,M as _,b as a,C as b,el as c,tl as d,ll as e,Qt as f,sl as g,Ht as h,Wt as i,al as j,Xt as n,Yt as s};
